# å“”å“©å“”å“©åŠ¨ç”»æ•°æ®çˆ¬å–åˆ†æ
æœ¬é¡¹ç›®ä¸ºSUFE æ•°æ®ç§‘å­¦å¯¼è®ºçš„è¯¾ç¨‹é¡¹ç›®

åŸºäºScrapyæ¡†æ¶çš„Bilibiliç•ªå‰§æ•°æ®é‡‡é›†ç³»ç»Ÿï¼Œå¯è‡ªåŠ¨æŠ“å–ç•ªå‰§åŸºæœ¬ä¿¡æ¯ã€è¯„åˆ†ã€æ’­æ”¾é‡ã€å¼¹å¹•åŠç”¨æˆ·è¯„è®ºï¼Œå¹¶æŒä¹…åŒ–å­˜å‚¨åˆ°MySQLæ•°æ®åº“ã€‚
## ğŸš€ åŠŸèƒ½ç‰¹æ€§

- **å¤šç»´åº¦æ•°æ®é‡‡é›†**
  - åŸºç¡€ä¿¡æ¯ï¼šç•ªå‰§åç§°ã€åª’ä½“IDã€æ ‡ç­¾ã€è¯„åˆ†
  - ç»Ÿè®¡æ•°æ®ï¼šæ’­æ”¾é‡ã€è¿½ç•ªäººæ•°ã€å¼¹å¹•æ•°
  - ç”¨æˆ·å†…å®¹ï¼šæœ€æ–°30æ¡çŸ­è¯„ï¼ˆå¯è°ƒæ•´ï¼Œä»…å°è¯•ï¼‰

- **~~æ™ºèƒ½ååçˆ¬ç­–ç•¥~~ï¼ˆä¸æ¨èï¼‰**
  - è‡ªåŠ¨è¯·æ±‚å¤´ç®¡ç†
  - éšæœºåŒ–è¯·æ±‚å»¶è¿Ÿ

- **é«˜æ•ˆæ•°æ®å­˜å‚¨**
  - MySQLæ‰¹é‡æ’å…¥
  - æ•°æ®æ¸…æ´—è½¬æ¢ï¼ˆä¸‡/äº¿çº§å•ä½è‡ªåŠ¨æ¢ç®—ï¼‰
  - å¼‚å¸¸æ•°æ®è¿‡æ»¤

## ğŸ“¦ é¡¹ç›®ç»“æ„

```bash
anime/
â”œâ”€â”€ spiders/
â”‚   â”œâ”€â”€ bili.py         # é€šç”¨ç•ªå‰§çˆ¬è™«
â”‚   â””â”€â”€ biliChina.py    # ä¸­å›½åŒºç‰¹ä¾›ç•ªå‰§çˆ¬è™«
â”œâ”€â”€ middlewares.py      # çˆ¬è™«ä¸­é—´ä»¶
â”œâ”€â”€ pipelines.py        # æ•°æ®å­˜å‚¨ç®¡é“
â”œâ”€â”€ items.py            # æ•°æ®æ¨¡å‹å®šä¹‰
â”œâ”€â”€ settings.py         # é…ç½®æ–‡ä»¶
â”œâ”€â”€ initialMySQL.py     # æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
â””â”€â”€ main.py             # çˆ¬è™«å¯åŠ¨å…¥å£
```

## âš™ï¸ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚

- Python 3.8+
- MySQL 5.7+
- Scrapy 2.11
- PyMySQL 

```bash
pip install scrapy pymysql
```

### æ•°æ®åº“é…ç½®

1. åˆ›å»ºæ•°æ®åº“ï¼ˆéœ€æå‰å®‰è£…MySQLï¼‰
```bash
mysql -u root -p -e "CREATE DATABASE finalpj CHARACTER SET utf8mb4"
```

2. åˆå§‹åŒ–è¡¨ç»“æ„

ç®€å•æ¥è¯´å°±æ˜¯åˆ è¡¨å’Œå»ºè¡¨

```bash
python initialMySQL.py
```

### è¿è¡Œçˆ¬è™«
åœ¨animeæ–‡ä»¶å¤¹é‡Œé¢è¿è¡Œï¼š
```bash
# è¿è¡Œé€šç”¨ç•ªå‰§çˆ¬è™«
scrapy crawl bili

# è¿è¡Œä¸­å›½åŒºç‰¹ä¾›ç•ªå‰§çˆ¬è™«
scrapy crawl biliChina
```

## ğŸ”§ é…ç½®è¯´æ˜

ä¿®æ”¹ `settings.py` é…ç½®é¡¹ï¼š
```python
import random

# æ•°æ®åº“é…ç½®ï¼ˆå»ºè®®ä½¿ç”¨ç¯å¢ƒå˜é‡ï¼‰
MYSQL_HOST = 'localhost'
MYSQL_USER = 'root'
MYSQL_PASSWORD = 'your_password'  # åŠ¡å¿…ä¿®æ”¹!
MYSQL_DB = 'finalpj'

# åçˆ¬ç›¸å…³é…ç½®
DOWNLOAD_DELAY = 0.1 + random.randrange(1, 5)/10               # è¯·æ±‚é—´éš”(ç§’)
ROBOTSTXT_OBEY = False           # æ˜¯å¦éµå®ˆrobotsåè®®
CONCURRENT_REQUESTS = 8          # å¹¶å‘è¯·æ±‚æ•°

# å…¶ä½™é…ç½®è¯¦æƒ…è¯·è§settings.py
```

## ğŸ“Š æ•°æ®æ ·ä¾‹

| media_id | name         | score | score_num | play    | follow  | barrage | tags               |comments|
|----------|--------------|-------|-----------|---------|---------|---------|--------------------|--------|
| 28232073  | Reï¼šä»é›¶å¼€å§‹çš„å¼‚ä¸–ç•Œç”Ÿæ´» ç¬¬äºŒå­£ ååŠ | 9.9  | 176198    | 100000000  | 9759000 | 1158000 | å°è¯´æ”¹,ç©¿è¶Š,å¥‡å¹»,å†’é™©     | 2023å¹´3æœˆ25æ—¥ä»é›¶å¼€å§‹çš„å¼‚ä¸–ç•Œç”Ÿæ´» ç¬¬ä¸‰å­£ å®£å¸ƒåˆ¶ä½œï¼,ç¬¬ä¸‰å­£ä»€ä¹ˆæ—¶å€™å‡ºå•Šå•Šå•Š,ç¥ä½œ,9.9ï¼ï¼ï¼ï¼,123,å€¼,1,1,æ— æ•Œ,ä¼˜è´¨åŠ¨æ¼«,æˆ‘çˆ± çˆ±èœœè‰é›…,å¥½,å¥½åˆ€,å¾9.8å˜9.9ï¼ŒBç«™æœ€é«˜çš„9.9,æ— æ•Œï¼Œæ°¸è¿œçš„re zero,å¥½... |
| 1733      | ç½—å°é»‘æˆ˜è®°                  | 9.9  | 149345    | 560000000  | 7594000 | 2712000 | åŸåˆ›,çƒ­è¡€,èŒç³»,æ²»æ„ˆ       | è‡ªä»çœ‹äº†è¿™ä¸ªåŠ¨æ¼«ï¼Œä¹Ÿä¸æŠ½çƒŸä¸å–é…’æ¯å¤©æ—©ç¡æ—©èµ·ã€‚å°±ä¸ºäº†èƒ½æ´»è¿‡ä½œè€…ã€‚,æ¯ä¸€æ¬¡æ›´æ–°æ’­æ”¾é‡éƒ½ä¼šæ¿€å¢ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºå¤§å®¶éƒ½ä¼šé€‰æ‹©ä»å¤´å†æ¥ä¸€éï¼Œä¹Ÿä¸ä¸€å®šæ˜¯å› ä¸ºçƒ­çˆ±ï¼Œä¸»è¦æ˜¯å‰è¾¹å‰§æƒ…éƒ½å¿˜...                         |
| 28223066  | æˆ‘çš„ä¸‰ä½“ä¹‹ç« åŒ—æµ·ä¼           | 9.9  | 148840    | 120000000  | 2559000 | 1120000 | å°è¯´æ”¹,ç§‘å¹»               | ç¥äº†ï¼ŒçœŸçš„è¶Šæ¥è¶Šå¥½äº†,æˆ‘ç¿»äº†äº”åˆ†é’Ÿæ²¡ç¿»å‡ºä¸€ä¸ªäº”æ˜Ÿä»¥ä¸‹çš„ï¼Œè°èƒ½å‘Šè¯‰æˆ‘9.9æ€ä¹ˆæ¥çš„ï¼Ÿè°æ˜¯å›å¾’ï¼Ÿ,è‰ºç”»å¼€å¤©çš„ä¸‰ä½“æƒ³æ‹çš„å¥½ï¼Œé¦–å…ˆå°±è¦è¶Šè¿‡è¿™åº§å¤§å±±ã€‚â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦æœç„¶ï¼Œå°±è¿˜åŸåº¦ã€é…éŸ³...                       |
| 102312    | ç¢§è“ä¹‹æµ·                    | 9.9  | 140275    | 170000000  | 4890000 | 1090000 | ç¤¾å›¢,æ¼«ç”»æ”¹,æç¬‘,è¿åŠ¨     | æœ‰ä¸€è¯´äºŒï¼Œæˆ‘è¦ç¬¬äºŒå­£,å‡ºç¬¬äºŒå­£ï¼Œæˆ‘å°±å»çœ‹é‚£ä¸ªè¯´å‡ºç¬¬äºŒå­£å»è£¸å¥”çš„äººï¼ˆdogeï¼‰,è¿™ç•ªè¦æ˜¯å‡ºç¬¬äºŒå­£ï¼Œæˆ‘è£¸å¥”å¾¡é€š,æˆ‘è¦ç¬¬äºŒå­£æˆ‘è¦ç¬¬äºŒå­£æˆ‘è¦ç¬¬äºŒå­£æˆ‘è¦ç¬¬äºŒå­£,æ„Ÿè°¢æ­¤ç•ªï¼Œä½“è„‚ç¬‘æ²¡äº†,ä¸‹ä¸€å­£,å¥½...                   |
| 28221403  | æ“…é•¿æ‰å¼„çš„é«˜æœ¨åŒå­¦ ç¬¬äºŒå­£  | 9.9  | 123425    | 75092000   | 3684000 | 1760000 | æ¼«ç”»æ”¹,æ‹çˆ±,æ ¡å›­,æç¬‘     | ä¸€äººè¡€ä¹¦å‡ºç¬¬ä¸‰å­£,ã€‚ã€‚å—¯ã€‚ä½ ä»¬æ‡‚å¾—ã€‚ã€‚ã€‚ä¸€ä¸ª19çš„è“å­©çº¸èººåœ¨åºŠä¸Šå‚»ç¬‘çš„çœ‹ç€ã€‚ã€‚ã€‚å’Œæˆ‘å·®ä¸å¤šçš„ä¸¾ä¸ªæ‰‹,æˆ‘å°±æƒ³çŸ¥é“ï¼Œè¿™0.1åˆ†æ˜¯è°æ‰£çš„ã€‚,ã€‚,é«˜æœ¨ä¸è¥¿ç‰‡çš„æ ¡å›­æ—¥å¸¸ï¼Œå¦‚èŠ¦æŸ‘å’Œç½—å‹’çš„æ··åˆæœé…±ï¼Œé‡Œé¢åŠ äº†å¤§é‡çš„ç³–ã€‚æ²¡æœ‰è¦æ¨çš„ä¸»çº¿ï¼Œæ²¡æœ‰è¦è§£å†³çš„ä»»åŠ¡ï¼Œæˆ‘ä»¬åªåœ¨ç”Ÿæ´»çš„ä¸­æœŸå¾…ä¸‹ä¸€ä¸ªç¾å¥½çš„å°æ•…äº‹ã€‚,ç”œç”œç”œï¼,ä¸å–œæ¬¢,è¡¥ä¸ªè¯„åˆ†ï¼Œæˆ‘æ°¸è¿œå–œæ¬¢é«˜æœ¨ï¼,æ— æ•Œ,ç”œåˆ°æ‰ç‰™äº†,åƒç³–å–½,æœ€å–œæ¬¢çš„æƒ…ä¾£ä¹‹ä¸€,é½æ­»æˆ‘äº†,ç¥ä¸­ç¥,å¥½è€¶ï¼,çœŸçš„å¤ªå–œæ¬¢å•¦,é…¸é…¸ç”œç”œçš„,æˆ‘çš„ä¸€åˆ‡å¹»æƒ³,å¥½çœ‹,çœŸçš„å¥½çœ‹,çœŸä¿‚ç¥ä½œ,å¥½ï¼,å¤ªæ£’äº†,ç¾å¥½çš„åˆä¸­ç”Ÿçš„æš§æ˜§ï¼Œæ˜¯ä¼šä»¤äººä¼šå¿ƒä¸€ç¬‘çš„å¥½ç•ª,ç¥ï¼,æˆ‘å¿ƒä¸­æœ€æ— æ•Œçš„çº¯çˆ±ï¼,å½“èµ,çœŸç¾å¥½å•Šï¼,ç¥ä½œï¼Œå¯æƒœå®Œç»“äº†ï¼Œè¿˜å¯ä»¥çœ‹æ¼«ç”»,æ»¡æ··æ»¡æ··ï¼Œå¿…é¡»æ»¡æ˜ï¼Œè°ä¸æ‰“æ»¡æ˜çœ‹ä¸èµ· |

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **åˆæ³•åˆè§„ä½¿ç”¨**
   - è¯·éµå®ˆBilibiliçš„[Robotsåè®®](https://www.bilibili.com/robots.txt)
   - æ§åˆ¶è¯·æ±‚é¢‘ç‡ï¼ˆå»ºè®®>1ç§’/è¯·æ±‚ï¼‰
   - ç¦æ­¢ç”¨äºå•†ä¸šç”¨é€”æˆ–å¤§è§„æ¨¡æŠ“å–

2. **æ•°æ®å®‰å…¨**
   ```python
   # æ•æ„Ÿä¿¡æ¯å»ºè®®é€šè¿‡ç¯å¢ƒå˜é‡é…ç½®
   import os
   MYSQL_PASSWORD = os.getenv('MYSQL_PWD')  # æ›´å®‰å…¨çš„é…ç½®æ–¹å¼
   ```

3. **æ€§èƒ½ä¼˜åŒ–**
   - å¯ç”¨AutoThrottleæ‰©å±•ï¼ˆ`settings.py`ä¸­å–æ¶ˆæ³¨é‡Šç›¸å…³é…ç½®ï¼‰
   - å»ºè®®ä½¿ç”¨Rediså®ç°åˆ†å¸ƒå¼çˆ¬å–

## ğŸ¤ å‚ä¸è´¡çŒ®

æ¬¢è¿æäº¤Issueæˆ–Pull Requestï¼š
1. Forkæœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/improvement`)
3. æäº¤ä¿®æ”¹ (`git commit -m 'Add some feature'`)
4. æ¨é€åˆ†æ”¯ (`git push origin feature/improvement`)
5. æ–°å»ºPull Request


